# 02-åŒ…ç®¡ç†å·¥å…·

## ğŸ› ï¸ åŒ…ç®¡ç†å·¥å…·æ¦‚è§ˆ

### ä»€ä¹ˆæ˜¯åŒ…ç®¡ç†å·¥å…·ï¼Ÿ
åŒ…ç®¡ç†å·¥å…·æ˜¯ç”¨äºå®‰è£…ã€å‡çº§ã€å¸è½½å’Œç®¡ç†PythonåŒ…çš„è½¯ä»¶å·¥å…·ã€‚å®ƒä»¬ç®€åŒ–äº†ä¾èµ–ç®¡ç†ï¼Œç¡®ä¿é¡¹ç›®çš„å¯é‡ç°æ€§ã€‚

### ä¸»è¦åŒ…ç®¡ç†å·¥å…·
- **pip**ï¼šPythonå®˜æ–¹åŒ…ç®¡ç†å·¥å…·
- **conda**ï¼šè·¨è¯­è¨€çš„åŒ…å’Œç¯å¢ƒç®¡ç†å™¨
- **poetry**ï¼šç°ä»£Pythonä¾èµ–ç®¡ç†å·¥å…·
- **pipenv**ï¼šç»“åˆpipå’Œvirtualenvçš„å·¥å…·
- **pip-tools**ï¼špipçš„å¢å¼ºå·¥å…·é›†

## ğŸ“¦ pip - Pythonå®˜æ–¹åŒ…ç®¡ç†å™¨

### pipåŸºç¡€ä½¿ç”¨
```bash
# å®‰è£…åŒ…
pip install package_name

# å®‰è£…ç‰¹å®šç‰ˆæœ¬
pip install package_name==1.2.3

# å®‰è£…ç‰ˆæœ¬èŒƒå›´
pip install "package_name>=1.0,<2.0"

# ä»requirements.txtå®‰è£…
pip install -r requirements.txt

# å‡çº§åŒ…
pip install --upgrade package_name

# å¸è½½åŒ…
pip uninstall package_name

# åˆ—å‡ºå·²å®‰è£…çš„åŒ…
pip list

# æ˜¾ç¤ºåŒ…ä¿¡æ¯
pip show package_name

# æ£€æŸ¥ä¾èµ–å…³ç³»
pip check
```

### pipé«˜çº§åŠŸèƒ½
```bash
# åªä¸‹è½½ä¸å®‰è£…
pip download package_name

# ä»æœ¬åœ°æ–‡ä»¶å®‰è£…
pip install ./my_package.tar.gz
pip install ./my_package/

# ä»Gitä»“åº“å®‰è£…
pip install git+https://github.com/user/repo.git

# å®‰è£…å¯ç¼–è¾‘æ¨¡å¼ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
pip install -e .

# ç”Ÿæˆrequirements.txt
pip freeze > requirements.txt

# å®‰è£…ç”¨æˆ·çº§åŒ…ï¼ˆä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
pip install --user package_name

# æŒ‡å®šç´¢å¼•æº
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ package_name
```

### requirements.txtè¯¦è§£
```txt
# requirements.txt ç¤ºä¾‹

# ç²¾ç¡®ç‰ˆæœ¬
requests==2.28.1

# ç‰ˆæœ¬èŒƒå›´
numpy>=1.21.0,<1.22.0

# å…¼å®¹ç‰ˆæœ¬
pandas~=1.3.0

# æœ€å°ç‰ˆæœ¬
matplotlib>=3.5.0

# å¼€å‘ä¾èµ–ï¼ˆé€šå¸¸å•ç‹¬æ–‡ä»¶ï¼‰
# requirements-dev.txt
pytest>=6.0.0
black>=22.0.0
flake8>=4.0.0

# ä»Gitå®‰è£…
git+https://github.com/user/repo.git@v1.0.0

# æœ¬åœ°åŒ…
-e ./local_package

# åŒ…å«å…¶ä»–requirementsæ–‡ä»¶
-r requirements-base.txt
```

### pipé…ç½®
```ini
# pip.conf (Linux/Mac: ~/.pip/pip.conf, Windows: %APPDATA%\pip\pip.ini)
[global]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple/
trusted-host = pypi.tuna.tsinghua.edu.cn
timeout = 60

[install]
user = true
```

## ğŸ conda - è·¨è¯­è¨€åŒ…ç®¡ç†å™¨

### condaåŸºç¡€æ¦‚å¿µ
```python
# condaçš„ä¼˜åŠ¿
conda_advantages = {
    "è·¨è¯­è¨€æ”¯æŒ": "ä¸ä»…æ”¯æŒPythonï¼Œè¿˜æ”¯æŒRã€C++ç­‰",
    "äºŒè¿›åˆ¶åŒ…": "é¢„ç¼–è¯‘åŒ…ï¼Œå®‰è£…é€Ÿåº¦å¿«",
    "ç¯å¢ƒç®¡ç†": "å†…ç½®è™šæ‹Ÿç¯å¢ƒç®¡ç†",
    "ç§‘å­¦è®¡ç®—": "ä¸“ä¸ºç§‘å­¦è®¡ç®—ä¼˜åŒ–",
    "ä¾èµ–è§£å†³": "å¼ºå¤§çš„ä¾èµ–è§£å†³ç®—æ³•"
}
```

### condaåŸºç¡€å‘½ä»¤
```bash
# å®‰è£…åŒ…
conda install package_name

# ä»ç‰¹å®šé¢‘é“å®‰è£…
conda install -c conda-forge package_name

# å®‰è£…å¤šä¸ªåŒ…
conda install numpy pandas matplotlib

# å‡çº§åŒ…
conda update package_name
conda update --all

# å¸è½½åŒ…
conda remove package_name

# åˆ—å‡ºåŒ…
conda list

# æœç´¢åŒ…
conda search package_name

# æ˜¾ç¤ºåŒ…ä¿¡æ¯
conda info package_name
```

### condaç¯å¢ƒç®¡ç†
```bash
# åˆ›å»ºç¯å¢ƒ
conda create -n myenv python=3.9

# åˆ›å»ºç¯å¢ƒå¹¶å®‰è£…åŒ…
conda create -n myenv python=3.9 numpy pandas

# æ¿€æ´»ç¯å¢ƒ
conda activate myenv

# åœç”¨ç¯å¢ƒ
conda deactivate

# åˆ—å‡ºç¯å¢ƒ
conda env list

# åˆ é™¤ç¯å¢ƒ
conda env remove -n myenv

# å¯¼å‡ºç¯å¢ƒ
conda env export > environment.yml

# ä»æ–‡ä»¶åˆ›å»ºç¯å¢ƒ
conda env create -f environment.yml
```

### environment.ymlæ–‡ä»¶
```yaml
# environment.yml ç¤ºä¾‹
name: myproject
channels:
  - conda-forge
  - defaults
dependencies:
  - python=3.9
  - numpy>=1.21
  - pandas>=1.3
  - matplotlib>=3.5
  - pip
  - pip:
    - requests>=2.25
    - click>=7.0
```

## ğŸ­ poetry - ç°ä»£ä¾èµ–ç®¡ç†

### poetryçš„ç‰¹ç‚¹
- **ä¾èµ–è§£æ**ï¼šæ™ºèƒ½ä¾èµ–è§£æå’Œé”å®š
- **é¡¹ç›®ç®¡ç†**ï¼šå®Œæ•´çš„é¡¹ç›®ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **æ„å»ºå‘å¸ƒ**ï¼šå†…ç½®æ„å»ºå’Œå‘å¸ƒåŠŸèƒ½
- **è™šæ‹Ÿç¯å¢ƒ**ï¼šè‡ªåŠ¨è™šæ‹Ÿç¯å¢ƒç®¡ç†

### poetryåŸºç¡€ä½¿ç”¨
```bash
# å®‰è£…poetry
curl -sSL https://install.python-poetry.org | python3 -

# åˆ›å»ºæ–°é¡¹ç›®
poetry new my-project

# åˆå§‹åŒ–ç°æœ‰é¡¹ç›®
poetry init

# å®‰è£…ä¾èµ–
poetry install

# æ·»åŠ ä¾èµ–
poetry add requests
poetry add pytest --group dev

# æ›´æ–°ä¾èµ–
poetry update

# åˆ é™¤ä¾èµ–
poetry remove requests

# æ˜¾ç¤ºä¾èµ–æ ‘
poetry show --tree

# è¿è¡Œå‘½ä»¤
poetry run python script.py

# æ¿€æ´»shell
poetry shell
```

### pyproject.tomlé…ç½®
```toml
# pyproject.toml ç¤ºä¾‹
[tool.poetry]
name = "my-project"
version = "0.1.0"
description = "A sample Python project"
authors = ["Your Name <you@example.com>"]
readme = "README.md"
packages = [{include = "my_project"}]

[tool.poetry.dependencies]
python = "^3.8"
requests = "^2.25.0"
click = "^7.0"

[tool.poetry.group.dev.dependencies]
pytest = "^6.0"
black = "^22.0"
flake8 = "^4.0"

[tool.poetry.group.docs.dependencies]
sphinx = "^4.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.scripts]
my-cli = "my_project.cli:main"
```

## ğŸ”§ å…¶ä»–åŒ…ç®¡ç†å·¥å…·

### pipenv
```bash
# å®‰è£…pipenv
pip install pipenv

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
pipenv install

# å®‰è£…åŒ…
pipenv install requests

# å®‰è£…å¼€å‘ä¾èµ–
pipenv install pytest --dev

# æ¿€æ´»ç¯å¢ƒ
pipenv shell

# è¿è¡Œå‘½ä»¤
pipenv run python script.py

# ç”Ÿæˆrequirements.txt
pipenv requirements > requirements.txt
```

### pip-tools
```bash
# å®‰è£…pip-tools
pip install pip-tools

# ä»requirements.inç”Ÿæˆrequirements.txt
pip-compile requirements.in

# åŒæ­¥ç¯å¢ƒ
pip-sync requirements.txt

# å‡çº§ä¾èµ–
pip-compile --upgrade requirements.in
```

## ğŸ“Š å·¥å…·å¯¹æ¯”

### åŠŸèƒ½å¯¹æ¯”è¡¨
```python
tool_comparison = {
    "ç‰¹æ€§": {
        "pip": "åŸºç¡€åŒ…ç®¡ç†",
        "conda": "è·¨è¯­è¨€+ç¯å¢ƒç®¡ç†",
        "poetry": "ç°ä»£é¡¹ç›®ç®¡ç†",
        "pipenv": "ç®€åŒ–çš„pip+virtualenv"
    },
    "ä¾èµ–è§£æ": {
        "pip": "åŸºç¡€",
        "conda": "å¼ºå¤§",
        "poetry": "æ™ºèƒ½",
        "pipenv": "ä¸­ç­‰"
    },
    "ç¯å¢ƒç®¡ç†": {
        "pip": "éœ€è¦virtualenv",
        "conda": "å†…ç½®",
        "poetry": "è‡ªåŠ¨",
        "pipenv": "å†…ç½®"
    },
    "æ„å»ºå‘å¸ƒ": {
        "pip": "éœ€è¦å…¶ä»–å·¥å…·",
        "conda": "æ”¯æŒ",
        "poetry": "å†…ç½®",
        "pipenv": "ä¸æ”¯æŒ"
    },
    "å­¦ä¹ æ›²çº¿": {
        "pip": "ç®€å•",
        "conda": "ä¸­ç­‰",
        "poetry": "ä¸­ç­‰",
        "pipenv": "ç®€å•"
    }
}
```

### é€‰æ‹©å»ºè®®
```python
# ä½¿ç”¨åœºæ™¯å»ºè®®
use_cases = {
    "åˆå­¦è€…": "pip + virtualenv",
    "æ•°æ®ç§‘å­¦": "conda",
    "ç°ä»£Pythoné¡¹ç›®": "poetry",
    "ç®€å•é¡¹ç›®": "pipenv",
    "ä¼ä¸šç¯å¢ƒ": "pip + pip-tools"
}
```

## ğŸ”’ åŒ…å®‰å…¨

### å®‰å…¨æ£€æŸ¥å·¥å…·
```bash
# ä½¿ç”¨safetyæ£€æŸ¥å·²çŸ¥æ¼æ´
pip install safety
safety check

# ä½¿ç”¨banditæ£€æŸ¥ä»£ç å®‰å…¨
pip install bandit
bandit -r my_project/

# ä½¿ç”¨pip-auditæ£€æŸ¥ä¾èµ–æ¼æ´
pip install pip-audit
pip-audit
```

### å®‰å…¨æœ€ä½³å®è·µ
```python
security_practices = {
    "ä¾èµ–å®¡è®¡": "å®šæœŸæ£€æŸ¥ä¾èµ–çš„å®‰å…¨æ¼æ´",
    "ç‰ˆæœ¬é”å®š": "ä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬æˆ–é”å®šæ–‡ä»¶",
    "æ¥æºéªŒè¯": "åªä»å¯ä¿¡æºå®‰è£…åŒ…",
    "æœ€å°æƒé™": "é¿å…ä½¿ç”¨sudoå®‰è£…åŒ…",
    "å®šæœŸæ›´æ–°": "åŠæ—¶æ›´æ–°æœ‰å®‰å…¨ä¿®å¤çš„åŒ…",
    "è™šæ‹Ÿç¯å¢ƒ": "ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®"
}
```

## ğŸ¯ æœ¬èŠ‚å°ç»“

- **pipåŸºç¡€**ï¼šæŒæ¡Pythonå®˜æ–¹åŒ…ç®¡ç†å™¨çš„ä½¿ç”¨
- **condaä¼˜åŠ¿**ï¼šäº†è§£ç§‘å­¦è®¡ç®—é¢†åŸŸçš„å¼ºå¤§å·¥å…·
- **poetryç°ä»£**ï¼šä½“éªŒç°ä»£Pythoné¡¹ç›®ç®¡ç†æ–¹å¼
- **å·¥å…·é€‰æ‹©**ï¼šæ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å·¥å…·
- **å®‰å…¨æ„è¯†**ï¼šé‡è§†åŒ…ç®¡ç†çš„å®‰å…¨æ€§

## ğŸ’¡ å…³é”®è¦ç‚¹

1. **å·¥å…·é€‰æ‹©**ï¼šæ ¹æ®é¡¹ç›®ç±»å‹å’Œå›¢é˜Ÿéœ€æ±‚é€‰æ‹©åˆé€‚çš„åŒ…ç®¡ç†å·¥å…·
2. **ç‰ˆæœ¬ç®¡ç†**ï¼šåˆç†ä½¿ç”¨ç‰ˆæœ¬çº¦æŸï¼Œä¿æŒé¡¹ç›®ç¨³å®šæ€§
3. **ç¯å¢ƒéš”ç¦»**ï¼šå§‹ç»ˆä½¿ç”¨è™šæ‹Ÿç¯å¢ƒè¿›è¡Œå¼€å‘
4. **ä¾èµ–é”å®š**ï¼šä½¿ç”¨é”å®šæ–‡ä»¶ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
5. **å®‰å…¨æ£€æŸ¥**ï¼šå®šæœŸæ£€æŸ¥ä¾èµ–çš„å®‰å…¨æ¼æ´

## ğŸ“š å»¶ä¼¸é˜…è¯»
- [pipç”¨æˆ·æŒ‡å—](https://pip.pypa.io/en/stable/user_guide/)
- [condaç”¨æˆ·æŒ‡å—](https://docs.conda.io/projects/conda/en/latest/user-guide/)
- [poetryæ–‡æ¡£](https://python-poetry.org/docs/)
- [PythonåŒ…å®‰å…¨æŒ‡å—](https://packaging.python.org/guides/analyzing-pypi-package-downloads/)
