# 05-标准库模块

## 📚 Python标准库概述

Python标准库是Python安装时自带的模块集合，提供了丰富的功能，涵盖了文件操作、网络编程、数据处理、系统管理等各个方面。掌握标准库可以大大提高开发效率，避免重复造轮子。

## 🔧 系统和运行时模块

### 1. sys模块 - 系统相关功能
```python
import sys

# Python版本信息
print(f"Python版本: {sys.version}")
print(f"版本信息: {sys.version_info}")

# 命令行参数
print(f"脚本名: {sys.argv[0]}")
print(f"参数列表: {sys.argv[1:]}")

# 模块搜索路径
print("模块搜索路径:")
for path in sys.path[:3]:
    print(f"  {path}")

# 系统平台
print(f"平台: {sys.platform}")

# 退出程序
# sys.exit(0)  # 正常退出
# sys.exit("错误信息")  # 带错误信息退出
```

### 2. os模块 - 操作系统接口
```python
import os

# 当前工作目录
print(f"当前目录: {os.getcwd()}")

# 改变工作目录
# os.chdir('/path/to/directory')

# 列出目录内容
files = os.listdir('.')
print(f"当前目录文件: {files[:5]}")  # 显示前5个

# 环境变量
print(f"PATH: {os.environ.get('PATH', '未设置')[:50]}...")
print(f"HOME: {os.environ.get('HOME', os.environ.get('USERPROFILE'))}")

# 路径操作
path = os.path.join('folder', 'subfolder', 'file.txt')
print(f"拼接路径: {path}")
print(f"目录名: {os.path.dirname(path)}")
print(f"文件名: {os.path.basename(path)}")
print(f"文件存在: {os.path.exists('README.md')}")

# 创建和删除目录
# os.makedirs('new_folder/subfolder', exist_ok=True)
# os.rmdir('empty_folder')  # 只能删除空目录
```

### 3. platform模块 - 平台信息
```python
import platform

print(f"系统: {platform.system()}")           # Windows, Linux, Darwin
print(f"版本: {platform.release()}")          # 系统版本
print(f"架构: {platform.machine()}")          # x86_64, AMD64
print(f"处理器: {platform.processor()}")      # 处理器信息
print(f"Python实现: {platform.python_implementation()}")  # CPython
print(f"详细信息: {platform.platform()}")     # 完整平台信息
```

## 📅 日期和时间模块

### 1. datetime模块 - 日期时间处理
```python
from datetime import datetime, date, time, timedelta

# 当前时间
now = datetime.now()
print(f"当前时间: {now}")
print(f"今天日期: {date.today()}")

# 创建特定时间
birthday = datetime(1990, 5, 15, 14, 30, 0)
print(f"生日: {birthday}")

# 时间格式化
print(f"格式化时间: {now.strftime('%Y-%m-%d %H:%M:%S')}")
print(f"中文格式: {now.strftime('%Y年%m月%d日 %H时%M分')}")

# 时间计算
tomorrow = now + timedelta(days=1)
last_week = now - timedelta(weeks=1)
print(f"明天: {tomorrow.date()}")
print(f"上周: {last_week.date()}")

# 解析时间字符串
time_str = "2024-01-15 10:30:00"
parsed_time = datetime.strptime(time_str, "%Y-%m-%d %H:%M:%S")
print(f"解析时间: {parsed_time}")
```

### 2. time模块 - 时间相关功能
```python
import time

# 时间戳
timestamp = time.time()
print(f"当前时间戳: {timestamp}")

# 格式化时间
formatted = time.strftime("%Y-%m-%d %H:%M:%S")
print(f"格式化时间: {formatted}")

# 睡眠
print("开始等待...")
time.sleep(1)  # 等待1秒
print("等待结束")

# 性能测量
start_time = time.perf_counter()
# 执行一些操作
sum(range(1000000))
end_time = time.perf_counter()
print(f"执行时间: {end_time - start_time:.4f}秒")
```

## 🔢 数学和随机模块

### 1. math模块 - 数学函数
```python
import math

# 常量
print(f"π = {math.pi}")
print(f"e = {math.e}")

# 基本函数
print(f"√16 = {math.sqrt(16)}")
print(f"2³ = {math.pow(2, 3)}")
print(f"log₁₀(100) = {math.log10(100)}")
print(f"sin(π/2) = {math.sin(math.pi/2)}")

# 取整函数
print(f"向上取整 3.2: {math.ceil(3.2)}")
print(f"向下取整 3.8: {math.floor(3.8)}")
print(f"截断 3.8: {math.trunc(3.8)}")

# 其他函数
print(f"绝对值 |-5|: {math.fabs(-5)}")
print(f"阶乘 5!: {math.factorial(5)}")
print(f"最大公约数 gcd(48,18): {math.gcd(48, 18)}")
```

### 2. random模块 - 随机数生成
```python
import random

# 随机整数
print(f"1-10随机整数: {random.randint(1, 10)}")
print(f"0-99随机整数: {random.randrange(0, 100, 2)}")  # 偶数

# 随机浮点数
print(f"0-1随机浮点数: {random.random()}")
print(f"1-10随机浮点数: {random.uniform(1, 10)}")

# 随机选择
colors = ['红', '绿', '蓝', '黄', '紫']
print(f"随机颜色: {random.choice(colors)}")
print(f"随机选择3个: {random.sample(colors, 3)}")

# 打乱列表
numbers = list(range(1, 11))
random.shuffle(numbers)
print(f"打乱后: {numbers}")

# 设置随机种子（用于可重现的随机数）
random.seed(42)
print(f"固定种子随机数: {random.randint(1, 100)}")
```

## 📄 文件和数据处理模块

### 1. json模块 - JSON数据处理
```python
import json

# Python对象转JSON
data = {
    'name': '张三',
    'age': 25,
    'skills': ['Python', 'JavaScript', 'SQL'],
    'is_student': False
}

# 转换为JSON字符串
json_str = json.dumps(data, ensure_ascii=False, indent=2)
print("JSON字符串:")
print(json_str)

# JSON字符串转Python对象
parsed_data = json.loads(json_str)
print(f"解析后的数据: {parsed_data}")

# 文件操作
# 写入JSON文件
with open('data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

# 读取JSON文件
with open('data.json', 'r', encoding='utf-8') as f:
    loaded_data = json.load(f)
    print(f"从文件加载: {loaded_data}")
```

### 2. csv模块 - CSV文件处理
```python
import csv

# 写入CSV文件
data = [
    ['姓名', '年龄', '城市'],
    ['张三', 25, '北京'],
    ['李四', 30, '上海'],
    ['王五', 28, '广州']
]

with open('people.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerows(data)

# 读取CSV文件
with open('people.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)

# 使用字典方式处理CSV
with open('people.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    for row in reader:
        print(f"{row['姓名']} - {row['年龄']}岁 - {row['城市']}")
```

### 3. pathlib模块 - 现代路径操作
```python
from pathlib import Path

# 创建路径对象
p = Path('my_folder/my_file.txt')
print(f"路径: {p}")
print(f"父目录: {p.parent}")
print(f"文件名: {p.name}")
print(f"文件主名: {p.stem}")
print(f"扩展名: {p.suffix}")

# 路径拼接
new_path = Path('documents') / 'projects' / 'python' / 'main.py'
print(f"拼接路径: {new_path}")

# 路径检查
current_file = Path(__file__) if '__file__' in globals() else Path('.')
print(f"当前文件存在: {current_file.exists()}")
print(f"是文件: {current_file.is_file()}")
print(f"是目录: {current_file.is_dir()}")

# 遍历目录
current_dir = Path('.')
for item in current_dir.iterdir():
    if item.is_file():
        print(f"文件: {item.name}")
```

## 🌐 网络和互联网模块

### 1. urllib模块 - URL处理
```python
from urllib.parse import urlparse, urljoin, quote, unquote
from urllib.request import urlopen

# URL解析
url = "https://www.example.com/path/page?query=value&lang=zh#section"
parsed = urlparse(url)
print(f"协议: {parsed.scheme}")
print(f"域名: {parsed.netloc}")
print(f"路径: {parsed.path}")
print(f"查询: {parsed.query}")
print(f"片段: {parsed.fragment}")

# URL拼接
base_url = "https://api.example.com/"
full_url = urljoin(base_url, "users/123")
print(f"完整URL: {full_url}")

# URL编码
text = "你好 世界"
encoded = quote(text)
decoded = unquote(encoded)
print(f"编码: {encoded}")
print(f"解码: {decoded}")
```

### 2. http.client模块 - HTTP客户端
```python
import http.client
import json

# 创建HTTPS连接
conn = http.client.HTTPSConnection("httpbin.org")

# 发送GET请求
conn.request("GET", "/get")
response = conn.getresponse()
print(f"状态码: {response.status}")
print(f"响应头: {dict(response.getheaders())}")

# 读取响应内容
data = response.read().decode('utf-8')
print(f"响应内容: {json.loads(data)}")

conn.close()
```

> **注意：** `http.client` 是一个相对底层的HTTP客户端，使用起来较为繁琐。在实际的开发工作中，几乎所有开发者都会使用更高级、更易用的第三方库 `requests` 来处理HTTP请求。`requests` 库提供了更简洁的API、自动连接管理、JSON解析等便利功能，我们将在后续章节中详细介绍。了解 `http.client` 有助于理解HTTP协议的底层工作方式。

## 🔧 实用工具模块

### 1. collections模块 - 特殊容器
```python
from collections import Counter, defaultdict, namedtuple, deque

# Counter - 计数器
text = "hello world"
counter = Counter(text)
print(f"字符计数: {counter}")
print(f"最常见的3个: {counter.most_common(3)}")

# defaultdict - 默认字典
dd = defaultdict(list)
dd['fruits'].append('apple')
dd['fruits'].append('banana')
print(f"默认字典: {dict(dd)}")

# namedtuple - 命名元组
Point = namedtuple('Point', ['x', 'y'])
p = Point(1, 2)
print(f"点坐标: x={p.x}, y={p.y}")

# deque - 双端队列
dq = deque([1, 2, 3])
dq.appendleft(0)  # 左端添加
dq.append(4)      # 右端添加
print(f"双端队列: {list(dq)}")
```

### 2. itertools模块 - 迭代工具
```python
import itertools

# 无限迭代器
counter = itertools.count(1, 2)  # 1, 3, 5, 7, ...
print(f"前5个奇数: {list(itertools.islice(counter, 5))}")

cycle = itertools.cycle(['A', 'B', 'C'])
print(f"循环前6个: {list(itertools.islice(cycle, 6))}")

# 组合迭代器
numbers = [1, 2, 3, 4]
print(f"排列(2): {list(itertools.permutations(numbers, 2))}")
print(f"组合(2): {list(itertools.combinations(numbers, 2))}")

# 分组
data = [1, 1, 2, 2, 2, 3, 3]
grouped = itertools.groupby(data)
for key, group in grouped:
    print(f"键 {key}: {list(group)}")
```

### 3. functools模块 - 函数工具
```python
from functools import lru_cache, partial, reduce

# lru_cache - 缓存装饰器
@lru_cache(maxsize=128)
def fibonacci(n):
    if n < 2:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

print(f"斐波那契数列第10项: {fibonacci(10)}")
print(f"缓存信息: {fibonacci.cache_info()}")

# partial - 偏函数
def multiply(x, y):
    return x * y

double = partial(multiply, 2)  # 固定第一个参数为2
triple = partial(multiply, 3)  # 固定第一个参数为3

print(f"2 * 5 = {double(5)}")
print(f"3 * 4 = {triple(4)}")

# reduce - 累积计算
numbers = [1, 2, 3, 4, 5]
sum_result = reduce(lambda x, y: x + y, numbers)
print(f"累加结果: {sum_result}")
```

## 🎯 本节小结

- **系统模块**：sys、os、platform提供系统级功能
- **时间模块**：datetime、time处理日期时间
- **数学模块**：math、random提供数学和随机功能
- **文件模块**：json、csv、pathlib处理文件和数据
- **网络模块**：urllib、http.client处理网络请求
- **工具模块**：collections、itertools、functools提供实用工具

## 💡 使用建议

1. **优先使用标准库**：在安装第三方库之前，先检查标准库是否有相应功能
2. **查阅文档**：标准库文档详细，遇到问题时多查阅官方文档
3. **性能考虑**：标准库模块通常经过优化，性能较好
4. **兼容性**：标准库随Python版本更新，注意版本兼容性

## 📚 下一步学习
学习完标准库模块后，接下来学习 **[06-高级特性.md](./06-高级特性.md)**，了解模块和包的高级功能。
