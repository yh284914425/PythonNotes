# 03-åˆ›å»ºæ¨¡å—

## ğŸ”§ åˆ›å»ºè‡ªå®šä¹‰æ¨¡å—

### åŸºæœ¬æ­¥éª¤
1. åˆ›å»ºä¸€ä¸ª`.py`æ–‡ä»¶
2. åœ¨æ–‡ä»¶ä¸­å®šä¹‰å‡½æ•°ã€ç±»æˆ–å˜é‡
3. æ·»åŠ æ–‡æ¡£å­—ç¬¦ä¸²
4. åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¯¼å…¥ä½¿ç”¨

### ç¤ºä¾‹ï¼šåˆ›å»ºæ•°å­¦å·¥å…·æ¨¡å—

**åˆ›å»ºæ–‡ä»¶ï¼šmath_tools.py**
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
math_tools.py - æ•°å­¦å·¥å…·æ¨¡å—

æä¾›å¸¸ç”¨çš„æ•°å­¦è®¡ç®—åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- åŸºæœ¬è¿ç®—
- å‡ ä½•è®¡ç®—
- æ•°è®ºå‡½æ•°

ä½œè€…: Pythonå­¦ä¹ è€…
ç‰ˆæœ¬: 1.0.0
"""

import math

# æ¨¡å—çº§å¸¸é‡
PI = 3.14159265359
E = 2.71828182846

def add(a, b):
    """
    åŠ æ³•è¿ç®—
    
    Args:
        a (float): ç¬¬ä¸€ä¸ªæ•°
        b (float): ç¬¬äºŒä¸ªæ•°
    
    Returns:
        float: ä¸¤æ•°ä¹‹å’Œ
    
    Examples:
        >>> add(2, 3)
        5
        >>> add(-1, 1)
        0
    """
    return a + b

def multiply(a, b):
    """ä¹˜æ³•è¿ç®—"""
    return a * b

def circle_area(radius):
    """
    è®¡ç®—åœ†çš„é¢ç§¯
    
    Args:
        radius (float): åœ†çš„åŠå¾„
    
    Returns:
        float: åœ†çš„é¢ç§¯
    
    Raises:
        ValueError: å½“åŠå¾„ä¸ºè´Ÿæ•°æ—¶
    """
    if radius < 0:
        raise ValueError("åŠå¾„ä¸èƒ½ä¸ºè´Ÿæ•°")
    return PI * radius ** 2

def is_prime(n):
    """
    åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•°
    
    Args:
        n (int): å¾…åˆ¤æ–­çš„æ•´æ•°
    
    Returns:
        bool: å¦‚æœæ˜¯è´¨æ•°è¿”å›Trueï¼Œå¦åˆ™è¿”å›False
    """
    if n < 2:
        return False
    for i in range(2, int(n ** 0.5) + 1):
        if n % i == 0:
            return False
    return True

class Calculator:
    """ç®€å•è®¡ç®—å™¨ç±»"""
    
    def __init__(self):
        self.result = 0
        self.history = []
    
    def add(self, value):
        """åŠ æ³•æ“ä½œ"""
        self.result += value
        self.history.append(f"+ {value} = {self.result}")
        return self.result
    
    def clear(self):
        """æ¸…ç©ºè®¡ç®—å™¨"""
        self.result = 0
        self.history.clear()

# æ¨¡å—æµ‹è¯•ä»£ç 
def _test():
    """æ¨¡å—æµ‹è¯•å‡½æ•°"""
    print("æµ‹è¯•math_toolsæ¨¡å—:")
    print(f"5 + 3 = {add(5, 3)}")
    print(f"åŠå¾„ä¸º3çš„åœ†é¢ç§¯ = {circle_area(3):.2f}")
    print(f"17æ˜¯è´¨æ•°: {is_prime(17)}")
    
    calc = Calculator()
    calc.add(10)
    calc.add(5)
    print(f"è®¡ç®—å™¨ç»“æœ: {calc.result}")

# å½“æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶æ‰§è¡Œæµ‹è¯•
if __name__ == "__main__":
    _test()
```

### ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å—

**åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨ï¼š**
```python
# main.py
import math_tools

# ä½¿ç”¨æ¨¡å—ä¸­çš„å‡½æ•°
result = math_tools.add(10, 20)
print(f"10 + 20 = {result}")

# ä½¿ç”¨æ¨¡å—ä¸­çš„å¸¸é‡
print(f"PIçš„å€¼: {math_tools.PI}")

# ä½¿ç”¨æ¨¡å—ä¸­çš„ç±»
calc = math_tools.Calculator()
calc.add(100)
print(f"è®¡ç®—ç»“æœ: {calc.result}")

# æˆ–è€…ä½¿ç”¨from...import
from math_tools import circle_area, is_prime
print(f"åŠå¾„ä¸º5çš„åœ†é¢ç§¯: {circle_area(5)}")
print(f"29æ˜¯è´¨æ•°: {is_prime(29)}")
```

## ğŸ“ æ¨¡å—æ–‡æ¡£è§„èŒƒ

### 1. æ¨¡å—çº§æ–‡æ¡£å­—ç¬¦ä¸²
```python
"""
æ¨¡å—å - ç®€çŸ­æè¿°

è¯¦ç»†æè¿°æ¨¡å—çš„åŠŸèƒ½ã€ç”¨é€”å’Œä½¿ç”¨æ–¹æ³•ã€‚

æ¨¡å—åŒ…å«çš„ä¸»è¦åŠŸèƒ½ï¼š
- åŠŸèƒ½1ï¼šæè¿°
- åŠŸèƒ½2ï¼šæè¿°
- åŠŸèƒ½3ï¼šæè¿°

ä½¿ç”¨ç¤ºä¾‹:
    import my_module
    result = my_module.some_function(arg1, arg2)

ä½œè€…: ä½œè€…å§“å
é‚®ç®±: author@example.com
ç‰ˆæœ¬: 1.0.0
åˆ›å»ºæ—¥æœŸ: 2024-01-01
æœ€åä¿®æ”¹: 2024-01-15
è®¸å¯è¯: MIT
"""
```

### 2. å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²
```python
def calculate_distance(x1, y1, x2, y2):
    """
    è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»
    
    Args:
        x1 (float): ç¬¬ä¸€ä¸ªç‚¹çš„xåæ ‡
        y1 (float): ç¬¬ä¸€ä¸ªç‚¹çš„yåæ ‡
        x2 (float): ç¬¬äºŒä¸ªç‚¹çš„xåæ ‡
        y2 (float): ç¬¬äºŒä¸ªç‚¹çš„yåæ ‡
    
    Returns:
        float: ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»
    
    Raises:
        TypeError: å½“è¾“å…¥ä¸æ˜¯æ•°å­—æ—¶
        ValueError: å½“åæ ‡å€¼æ— æ•ˆæ—¶
    
    Examples:
        >>> calculate_distance(0, 0, 3, 4)
        5.0
        >>> calculate_distance(1, 1, 4, 5)
        5.0
    
    Note:
        ä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»å…¬å¼: sqrt((x2-x1)Â² + (y2-y1)Â²)
    """
    import math
    return math.sqrt((x2 - x1)**2 + (y2 - y1)**2)
```

### 3. ç±»æ–‡æ¡£å­—ç¬¦ä¸²
```python
class BankAccount:
    """
    é“¶è¡Œè´¦æˆ·ç±»
    
    ç”¨äºæ¨¡æ‹Ÿé“¶è¡Œè´¦æˆ·çš„åŸºæœ¬æ“ä½œï¼ŒåŒ…æ‹¬å­˜æ¬¾ã€å–æ¬¾å’ŒæŸ¥è¯¢ä½™é¢ã€‚
    
    Attributes:
        account_number (str): è´¦æˆ·å·ç 
        balance (float): è´¦æˆ·ä½™é¢
        owner (str): è´¦æˆ·æ‰€æœ‰è€…
    
    Examples:
        >>> account = BankAccount("123456", "å¼ ä¸‰", 1000)
        >>> account.deposit(500)
        1500.0
        >>> account.withdraw(200)
        1300.0
    """
    
    def __init__(self, account_number, owner, initial_balance=0):
        """
        åˆå§‹åŒ–é“¶è¡Œè´¦æˆ·
        
        Args:
            account_number (str): è´¦æˆ·å·ç 
            owner (str): è´¦æˆ·æ‰€æœ‰è€…
            initial_balance (float, optional): åˆå§‹ä½™é¢ï¼Œé»˜è®¤ä¸º0
        """
        self.account_number = account_number
        self.owner = owner
        self.balance = initial_balance
```

## ğŸ—ï¸ æ¨¡å—ç»“æ„æœ€ä½³å®è·µ

### 1. æ ‡å‡†æ¨¡å—ç»“æ„
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²"""

# 1. å¯¼å…¥æ ‡å‡†åº“
import os
import sys
from datetime import datetime

# 2. å¯¼å…¥ç¬¬ä¸‰æ–¹åº“
import requests
import numpy as np

# 3. å¯¼å…¥æœ¬åœ°æ¨¡å—
from .utils import helper_function

# 4. æ¨¡å—çº§å¸¸é‡ï¼ˆå…¨å¤§å†™ï¼‰
DEFAULT_TIMEOUT = 30
MAX_RETRIES = 3
API_VERSION = "v1"

# 5. æ¨¡å—çº§å˜é‡
_private_cache = {}
public_config = {}

# 6. å¼‚å¸¸ç±»å®šä¹‰
class CustomError(Exception):
    """è‡ªå®šä¹‰å¼‚å¸¸ç±»"""
    pass

# 7. ç§æœ‰å‡½æ•°ï¼ˆä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰
def _internal_helper():
    """å†…éƒ¨è¾…åŠ©å‡½æ•°"""
    pass

# 8. å…¬å…±å‡½æ•°
def public_function():
    """å…¬å…±å‡½æ•°"""
    pass

# 9. ç±»å®šä¹‰
class PublicClass:
    """å…¬å…±ç±»"""
    pass

# 10. ä¸»ç¨‹åºå…¥å£
def main():
    """ä¸»å‡½æ•°"""
    pass

# 11. æ¨¡å—æµ‹è¯•ä»£ç 
if __name__ == "__main__":
    main()
```

### 2. __all__ å˜é‡çš„ä½¿ç”¨
```python
# å®šä¹‰æ¨¡å—çš„å…¬å…±æ¥å£
__all__ = [
    'public_function',
    'PublicClass',
    'DEFAULT_TIMEOUT',
    'CustomError'
]

# è¿™æ ·from module import * åªä¼šå¯¼å…¥__all__ä¸­çš„å†…å®¹
```

### 3. ç‰ˆæœ¬ä¿¡æ¯ç®¡ç†
```python
# version.py æˆ–åœ¨ä¸»æ¨¡å—ä¸­
__version__ = "1.2.3"
__author__ = "Your Name"
__email__ = "your.email@example.com"
__license__ = "MIT"

# ç‰ˆæœ¬ä¿¡æ¯å‡½æ•°
def get_version():
    """è·å–ç‰ˆæœ¬ä¿¡æ¯"""
    return {
        'version': __version__,
        'author': __author__,
        'email': __email__,
        'license': __license__
    }
```

## ğŸ§ª æ¨¡å—æµ‹è¯•

### 1. å†…ç½®æµ‹è¯•
```python
def _test_functions():
    """æµ‹è¯•æ¨¡å—ä¸­çš„å‡½æ•°"""
    # æµ‹è¯•addå‡½æ•°
    assert add(2, 3) == 5, "addå‡½æ•°æµ‹è¯•å¤±è´¥"
    assert add(-1, 1) == 0, "addå‡½æ•°è´Ÿæ•°æµ‹è¯•å¤±è´¥"
    
    # æµ‹è¯•circle_areaå‡½æ•°
    area = circle_area(1)
    assert abs(area - PI) < 0.001, "circle_areaå‡½æ•°æµ‹è¯•å¤±è´¥"
    
    print("æ‰€æœ‰æµ‹è¯•é€šè¿‡!")

if __name__ == "__main__":
    _test_functions()
```

### 2. ä½¿ç”¨doctest
```python
def factorial(n):
    """
    è®¡ç®—é˜¶ä¹˜
    
    >>> factorial(5)
    120
    >>> factorial(0)
    1
    >>> factorial(1)
    1
    """
    if n <= 1:
        return 1
    return n * factorial(n - 1)

if __name__ == "__main__":
    import doctest
    doctest.testmod()  # è¿è¡Œæ–‡æ¡£å­—ç¬¦ä¸²ä¸­çš„æµ‹è¯•
```

### 3. å•å…ƒæµ‹è¯•
```python
# test_math_tools.py
import unittest
from math_tools import add, circle_area, is_prime

class TestMathTools(unittest.TestCase):
    
    def test_add(self):
        """æµ‹è¯•åŠ æ³•å‡½æ•°"""
        self.assertEqual(add(2, 3), 5)
        self.assertEqual(add(-1, 1), 0)
        self.assertEqual(add(0, 0), 0)
    
    def test_circle_area(self):
        """æµ‹è¯•åœ†é¢ç§¯è®¡ç®—"""
        self.assertAlmostEqual(circle_area(1), 3.14159, places=4)
        with self.assertRaises(ValueError):
            circle_area(-1)
    
    def test_is_prime(self):
        """æµ‹è¯•è´¨æ•°åˆ¤æ–­"""
        self.assertTrue(is_prime(17))
        self.assertFalse(is_prime(18))
        self.assertFalse(is_prime(1))

if __name__ == "__main__":
    unittest.main()
```

## ğŸ”§ æ¨¡å—é…ç½®å’Œè®¾ç½®

### 1. é…ç½®æ–‡ä»¶æ”¯æŒ
```python
# config.py
import os
import json

class Config:
    """é…ç½®ç®¡ç†ç±»"""
    
    def __init__(self, config_file='config.json'):
        self.config_file = config_file
        self.settings = self.load_config()
    
    def load_config(self):
        """åŠ è½½é…ç½®æ–‡ä»¶"""
        if os.path.exists(self.config_file):
            with open(self.config_file, 'r') as f:
                return json.load(f)
        return self.get_default_config()
    
    def get_default_config(self):
        """è·å–é»˜è®¤é…ç½®"""
        return {
            'debug': False,
            'timeout': 30,
            'max_retries': 3
        }
    
    def get(self, key, default=None):
        """è·å–é…ç½®é¡¹"""
        return self.settings.get(key, default)

# å…¨å±€é…ç½®å®ä¾‹
config = Config()
```

### 2. ç¯å¢ƒå˜é‡æ”¯æŒ
```python
import os

# ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®
DEBUG = os.getenv('DEBUG', 'False').lower() == 'true'
DATABASE_URL = os.getenv('DATABASE_URL', 'sqlite:///default.db')
SECRET_KEY = os.getenv('SECRET_KEY', 'default-secret-key')

def get_config():
    """è·å–é…ç½®ä¿¡æ¯"""
    return {
        'debug': DEBUG,
        'database_url': DATABASE_URL,
        'secret_key': SECRET_KEY
    }
```

## ğŸ¯ æœ¬èŠ‚å°ç»“

- **åˆ›å»ºæ­¥éª¤**ï¼šåˆ›å»º.pyæ–‡ä»¶ï¼Œå®šä¹‰å‡½æ•°/ç±»ï¼Œæ·»åŠ æ–‡æ¡£ï¼Œå¯¼å…¥ä½¿ç”¨
- **æ–‡æ¡£è§„èŒƒ**ï¼šæ¨¡å—ã€å‡½æ•°ã€ç±»éƒ½è¦æœ‰æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²
- **ç»“æ„æœ€ä½³å®è·µ**ï¼šéµå¾ªæ ‡å‡†ç»“æ„ï¼Œä½¿ç”¨__all__å®šä¹‰å…¬å…±æ¥å£
- **æµ‹è¯•æ–¹æ³•**ï¼šå†…ç½®æµ‹è¯•ã€doctestã€å•å…ƒæµ‹è¯•
- **é…ç½®ç®¡ç†**ï¼šæ”¯æŒé…ç½®æ–‡ä»¶å’Œç¯å¢ƒå˜é‡

## ğŸ“š ä¸‹ä¸€æ­¥å­¦ä¹ 
å­¦ä¹ å®Œåˆ›å»ºæ¨¡å—åï¼Œæ¥ä¸‹æ¥å­¦ä¹  **[04-åŒ…çš„æ¦‚å¿µ.md](./04-åŒ…çš„æ¦‚å¿µ.md)**ï¼Œäº†è§£å¦‚ä½•ç»„ç»‡å¤šä¸ªæ¨¡å—ã€‚
